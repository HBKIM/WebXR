<!DOCTYPE html>
<html>
<head>
  <title>Babylon.js VR with Image and Sphere</title>
  <style>
    html, body { margin: 0; padding: 0; overflow: hidden; height: 100%; }
    canvas { width: 100%; height: 100%; display: block; }
  </style>
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
</head>
<body>
  <canvas id="renderCanvas"></canvas>
  <script>
    const canvas = document.getElementById("renderCanvas");
    const engine = new BABYLON.Engine(canvas, true);
    const scene = new BABYLON.Scene(engine);

    // 기본 조명
    const light = new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0, 1, 0), scene);
    light.intensity = 1.5;

    // 구 생성 (초기에는 숨김)
    const sphere = BABYLON.MeshBuilder.CreateSphere("sphere", {diameter: 2}, scene);
    sphere.isVisible = false;

    // GUI 이미지 생성
    const advancedTexture = BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI("UI");
    const image = new BABYLON.GUI.Image("girlImage", "girl.png");
    image.width = "150px";
    image.height = "150px";
    image.horizontalAlignment = BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT;
    image.verticalAlignment = BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP;
    image.paddingTop = 10;
    image.paddingLeft = 10;
    advancedTexture.addControl(image);

    // WebXR VR 모드 진입 및 구 위치 설정
    scene.createDefaultXRExperienceAsync().then((xrHelper) => {
      const xrCamera = xrHelper.baseExperience.camera;

      // 구를 XR 카메라 앞쪽에 배치
      sphere.position = xrCamera.position.add(new BABYLON.Vector3(0, 0, -2));
      sphere.isVisible = true;

      xrHelper.baseExperience.enterXRAsync("immersive-vr", "local-floor").then(() => {
        console.log("Entered immersive VR mode");
      });
    });

    // 렌더 루프
    engine.runRenderLoop(() => {
      scene.render();
    });

    // 창 크기 변경 대응
    window.addEventListener("resize", () => {
      engine.resize();
    });
  </script>
</body>
</html>
